# SPDX-FileCopyrightText: (c) 2025 Tenstorrent AI ULC
#
# SPDX-License-Identifier: Apache-2.0

# JAX Inference tensor-parallel test configuration
# Use Python enum names or values for fields below (names preferred for readability):
#   - status: ModelTestStatus names (e.g., EXPECTED_PASSING) or values (e.g., expected_passing)
#   - bringup_status (if present): BringupStatus names (e.g., FAILED_TTMLIR_COMPILATION) or values (e.g., failed_ttmlir_compilation)

test_config:
  alexnet/image_classification/jax-custom_1x2-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: EXPECTED_PASSING
    markers: [nightly]

  alexnet/image_classification/jax-custom_1x4-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: NOT_SUPPORTED_SKIP
    bringup_status: FAILED_RUNTIME
    reason: "Hangs in runtime - https://github.com/tenstorrent/tt-xla/issues/2440"

  alexnet/image_classification/jax-custom_1x8-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: NOT_SUPPORTED_SKIP
    bringup_status: FAILED_RUNTIME
    reason: "Hangs in runtime - https://github.com/tenstorrent/tt-xla/issues/2440"

  falcon/jax-tiiuae/Falcon3-1B-Base-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: EXPECTED_PASSING
    assert_pcc: false
    reason: "Severe PCC comparison failed: pcc=0.066 < 0.99 required"

  mnist/image_classification/jax-mlp_custom_1x2-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: EXPECTED_PASSING
    markers: [nightly]

  mnist/image_classification/jax-mlp_custom_1x4-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: EXPECTED_PASSING

  mnist/image_classification/jax-mlp_custom_1x8-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: EXPECTED_PASSING

  gpt2/causal_lm/jax-base-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: KNOWN_FAILURE_XFAIL
    reason: "'stablehlo.gather' op slice size out of bounds - https://github.com/tenstorrent/tt-mlir/issues/6653"
    bringup_status: FAILED_TTMLIR_COMPILATION
    markers: [nightly]

  gpt2/causal_lm/jax-large-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: KNOWN_FAILURE_XFAIL
    reason: "'stablehlo.gather' op slice size out of bounds - https://github.com/tenstorrent/tt-mlir/issues/6653"
    bringup_status: FAILED_TTMLIR_COMPILATION
  
  gpt2/causal_lm/jax-medium-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: KNOWN_FAILURE_XFAIL
    reason: "'stablehlo.gather' op slice size out of bounds - https://github.com/tenstorrent/tt-mlir/issues/6653"
    bringup_status: FAILED_TTMLIR_COMPILATION
  
  gpt2/causal_lm/jax-xl-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: KNOWN_FAILURE_XFAIL
    reason: "'stablehlo.gather' op slice size out of bounds - https://github.com/tenstorrent/tt-mlir/issues/6653"
    bringup_status: FAILED_TTMLIR_COMPILATION
  
  llama/causal_lm/jax-1B_TINY-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: EXPECTED_PASSING

  llama/causal_lm/jax-3b-v2-tensor_parallel-inference:
    supported_archs: ["n300-llmbox"]
    status: EXPECTED_PASSING
    assert_pcc: false
    reason: "Severe PCC comparison failed: pcc=0.144 < 0.99 required"
  
